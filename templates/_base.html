<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>{% block title %}NailMart India{% endblock %}</title>

  {% block seo %}
<meta name="description" content="NailMart India ‚Äì Buy premium press-on nails, nail accessories & professional nail products online in India." />
{% endblock %}


  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
  <meta name="csrf-token" content="{{ csrf_token() }}">
{# ... (previous content of _base.html) ... #}

<script>
function getEstimatedDeliveryDate(pin) {
    const metro = ['110', '400', '560', '600', '700', '500'];
    const tier2 = ['302', '395', '411', '641', '751'];
    const prefix = pin.substring(0, 3);
    let days = 7;

    if (metro.includes(prefix)) days = 3;
    else if (tier2.includes(prefix)) days = 5;

    const today = new Date();
    today.setDate(today.getDate() + days);

    const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
    return today.toLocaleDateString('en-IN', options);
}

function checkEDD(pinInputId, resultId) {
    const pin = document.getElementById(pinInputId).value;
    const display = document.getElementById(resultId);
    if (!/^\d{6}$/.test(pin)) {
        display.innerText = "‚ùå Enter valid 6-digit Pincode.";
        display.classList.add("text-red-600");
        return;
    }

    const edd = getEstimatedDeliveryDate(pin);
    display.innerText = "üì¶ Expected delivery by: " + edd;
    display.classList.remove("text-red-600");
    display.classList.add("text-green-600");
}



  document.addEventListener("DOMContentLoaded", function () {
    const marquee = document.getElementById("customMarquee");
    const track = marquee?.querySelector(".marquee-track");

    if (!marquee || !track) return;

    marquee.addEventListener("touchstart", () => {
      track.style.animationPlayState = "paused";
    });

    marquee.addEventListener("touchend", () => {
      track.style.animationPlayState = "running";
    });
  });
</script>





<style>
    /* Ensure consistent box-sizing for all elements */
    *, *::before, *::after {
        box-sizing: border-box;
    }

    /* Ensure smooth scrolling and touch action for elements with overflow-x-scroll */
    /* This rule is crucial and uses !important to override potential conflicts */
    .overflow-x-scroll {
        scroll-behavior: smooth !important; /* Force smooth scrolling */
        overflow-x: scroll !important; /* Force scroll behavior */
        -webkit-overflow-scrolling: touch; /* Enable momentum scrolling on iOS */
        touch-action: pan-x pan-y; /* Allow horizontal panning for touch events */
    }

    /* Your existing styles in _base.html */
    /* ... */
</style>

{# ... (rest of _base.html) ... #}

    <style>

           /* Ensure smooth scrolling for elements with overflow-x-scroll */
    .overflow-x-scroll {
        scroll-behavior: smooth !important; /* Force smooth scrolling */
    }


        .footer h5 {
            color: #FAF9F6;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .footer p, .footer li {
            color: #FAF9F6;
            font-size: 0.95rem;
        }

        .footer a {
            color: #FAF9F6;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer a:hover {
            color: #2E8B57; 
        }

        .social-icons a {
            color: #FAF9F6;
            font-size: 1.5rem;
            margin-right: 15px;
            transition: color 0.3s ease, transform 0.2s ease;
        }

        .social-icons a:hover {
            color: #2E8B57; 
            transform: scale(1.1);
        }

        /* General Button Styling (overriding Bootstrap for theme) */
        .btn-primary {
            background-color: #FF8C00; 
            border-color: #FF8C00;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-primary:hover {
            background-color: #FFA500; 
            border-color: #FFA500;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-success {
            background-color: #2E8B57; 
            border-color: #2E8B57;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-success:hover {
            background-color: #3CB371; 
            border-color: #3CB371;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-info {
            background-color: #17a2b8; 
            border-color: #17a2b8;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-info:hover {
            background-color: #138496;
            border-color: #138496;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-secondary {
            background-color: #6c757d; 
            border-color: #6c757d;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background-color: #5a6268;
            border-color: #545b62;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        /* Card Styling */
        .card {
            border: none; 
            border-radius: 1rem; 
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08); 
            overflow: hidden; 
        }

        .card-header {
            background-color: #F0F0F0; 
            border-bottom: 1px solid #e0e0e0;
            font-weight: 600;
            color: #333333;
        }

        /* Form Controls */
        .form-control, .form-select {
            border-radius: 0.5rem;
            border: 1px solid #ced4da;
            padding: 0.75rem 1rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: #FF8C00; 
            box-shadow: 0 0 0 0.25rem rgba(255, 140, 0, 0.25);
        }

        /* Specific elements from all_products.html that might need styling */
        .product-grid {
            /* Styles already defined in all_products.html extra_css_from_page block */
        }

        .product-card {
            /* Styles already defined in all_products.html extra_css_from_page block */
        }

        .product-card .rating {
            color: #FFBF00; 
        }

        .product-card .final-price {
            color: #FF4500; 
        }

        /* Admin Dashboard Cards */
        .card.bg-primary { background-color: #FF8C00 !important; } 
        .card.bg-success { background-color: #2E8B57 !important; } 
        .card.bg-info { background-color: #17a2b8 !important; }
        .card.bg-warning { background-color: #FFBF00 !important; color: #333 !important; } 

        /* Responsive Adjustments */
        @media (max-width: 991.98px) {
            .navbar-nav {
                text-align: center;
                margin-top: 1rem;
                width: 100%; /* Ensure they take full width */
            }
            .navbar-nav .nav-item {
                margin-bottom: 0.5rem;
            }
            .navbar-nav .nav-item .btn-primary {
                width: 80%;
                margin: 0.5rem auto;
            }
            /* Adjust search form for small screens */
            .navbar form.d-flex {
                flex-direction: column;
                align-items: center;
                width: 100%;
                margin-top: 1rem;
                margin-bottom: 1rem; /* Added bottom margin for spacing */
            }
            .navbar form.d-flex .form-control {
                width: 90%;
                margin-bottom: 0.5rem;
            }
            .navbar form.d-flex .btn-outline-light {
                width: 90%;
            }
            /* Ensure the collapse is correctly managed for the hamburger menu */
            .navbar-collapse {
                flex-grow: 1; /* Allow it to take up space when expanded */
                padding-left: 1rem; /* Add padding to the collapsed menu content */
                padding-right: 1rem;
            }
        }
        /* New Styles for larger screens to align search and buttons */
        @media (min-width: 992px) {
            /* The .navbar-collapse should handle the main distribution */
            .navbar-collapse {
                display: flex !important; /* Ensure it's flex on large screens */
                flex-grow: 1; 
                justify-content: flex-end; /* Pushes content to the right */
                align-items: center; 
                width: auto; 
            }
            /* The me-auto and ms-auto classes in HTML now handle alignment, no custom margin here */
        }
        #announcementText {
  transition: opacity 0.3s ease;
}

.custom-link {
  color: #ff4da6;
  font-weight: 600;
  margin-left: 6px;
  text-decoration: underline;
}

.whatsapp-link {
  margin-left: 8px;
  display: inline-flex;
  align-items: center;
}
/* üîπ WhatsApp icon ‚Äî Announcement Bar */
.wa-icon-announcement {
  font-size: 14px;
  color: #25D366;
  margin-left: 6px;
  vertical-align: middle;
}

/* üîπ WhatsApp icon ‚Äî Marquee Bar */
.wa-icon-marquee {
  font-size: 18px;
  color: #25D366;
  margin-left: 6px;
  display: inline-block;
  vertical-align: middle;
  animation: pulse 1.6s infinite;
}



#announcementBar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 9999 !important; /* üîí absolute top layer */
}
#mainNavbar {
  position: fixed;
  top: 36px;           /* EXACTLY below announcement bar */
  width: 100%;
  z-index: 9000;
}

/* üîí Prevent Swiper from ever crossing top bars */
.swiper,
.swiper-wrapper,
.swiper-slide,
.product-card {
  z-index: 1 !important;
}


@keyframes pulse {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.15);
    opacity: 0.85;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

    </style>
    {% block extra_css %}{% endblock %}
</head>
<body class="flex flex-col min-h-screen">
<!-- Announcement Bar -->
<div id="announcementBar"
     class="fixed top-0 left-0 w-full z-[100]
            text-center text-sm font-semibold text-white
            bg-gradient-to-r from-pink-600 to-purple-600
            py-2">

  <span id="announcementText"></span>
</div>


    <nav id="mainNavbar" class="navbar fixed-top w-full z-[90] navbar-expand-lg"> 
        <div class="container-fluid px-4 md:px-8 lg:px-12 flex items-center justify-between"> <a class="navbar-brand flex items-center" href="{{ url_for('index') }}"> 
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="NailMart India Logo" style="height: 40px; margin-right: 10px;">
                <span>NailMart India</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav"> 
                <ul class="navbar-nav me-auto mb-2 mb-lg-0"> 
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('all_products') }}">Products</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('contact') }}">Contact</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('about') }}">About</a>
                    </li>
                </ul>

             {# Search Form - Adjusted for better mobile centering #}
{# On large screens (lg), it will be ms-auto (margin-left auto) to push right #}
{# On smaller screens, d-flex and justify-content-center will center it #}
                <form class="d-flex ms-auto me-2 my-2 my-lg-0 flex-grow-1 justify-content-center"
      action="{{ url_for('all_products') }}" method="GET"> {# ADDED action and method #}
    <input class="form-control me-2" type="search"
       placeholder=""
       aria-label="Search" name="search"
       id="animatedSearch">
 {# ADDED name="search" #}
    <button class="btn btn-outline-light" type="submit">Search</button>
</form>



                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link cart-icon-container" href="{{ url_for('cart') }}">
                            <i class="fas fa-shopping-cart"></i> Cart
                            <span class="badge rounded-pill" id="cart-count">0</span>
                        </a>
                    </li>
                    {% if current_user.is_authenticated %}
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user-circle me-1"></i> {{ current_user.full_name or current_user.email }}
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" href="{{ url_for('user_profile') }}">My Profile</a></li>
                                <li><a class="dropdown-item" href="{{ url_for('user_orders') }}">My Orders</a></li>
                                {% if current_user.is_admin() %}
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item" href="{{ url_for('admin_dashboard') }}">Admin Dashboard</a></li>
                                {% endif %}
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{{ url_for('logout') }}">Logout</a></li>
                            </ul>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link btn btn-primary px-4 py-2 rounded-md" href="{{ url_for('user_login') }}">Login</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link btn btn-primary px-4 py-2 rounded-md" href="{{ url_for('signup') }}">Sign Up</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
    <main class="flex-grow">
        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <div class="container mx-auto px-4 py-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h5 class="text-xl mb-3">NailMart India</h5>
                   <p class="text-sm">
Premium nail products, press-on nails & professional nail accessories.
Trusted by nail artists & home users across India.
</p> 
                </div>
                <div>
                    <h5 class="text-xl mb-3">Quick Links</h5>
                    <ul class="space-y-2">
                        <li><a href="{{ url_for('index') }}" class="text-sm hover:underline">Home</a></li>
                        <li><a href="{{ url_for('all_products') }}" class="text-sm hover:underline">Products</a></li>
                        <li><a href="{{ url_for('user_orders') }}" class="text-sm hover:underline">My Orders</a></li>
                        <li><a href="{{ url_for('contact') }}" class="text-sm hover:underline">Contact Us</a></li>
                        <li><a href="{{ url_for('user_login') }}" class="text-sm hover:underline">Login</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="text-xl mb-3">Contact Us</h5>
                    <p class="text-sm">
                        Annapurna Apartment, New Alipore<br>
                        West Bengal, 700053, India<br>
                        Email: smarasada@gmail.com<br>
                        Phone: +91 9330480697
                    </p>
                    <div class="social-icons mt-4">
                        <a href="#" class="mr-3"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="mr-3"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="mr-3"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="mr-3"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
            </div>
            <div class="text-center border-t border-gray-700 pt-6 mt-8">
                <p class="text-sm">&copy; {{ now.year }} NailMart India. All rights reserved.</p>
            </div>
        </div>
    </footer>

   <!-- üîª Bottom Fixed Marquee Bar -->
<div id="customMarquee"
     class="fixed bottom-0 left-0 w-full z-[10050]
            bg-gradient-to-r from-pink-600 to-purple-700
            text-white text-sm font-semibold overflow-hidden
            pointer-events-none">

  <div class="marquee-track pointer-events-auto">
    ‚ú® <strong>Want CUSTOMIZED NAILS üíÖüèª ??</strong>

    <a href="https://wa.me/919330482697?text=Hi%20NaiLMart%2C%20I%20want%20a%20custom%20nail%20design."
       target="_blank"
       class="marquee-whatsapp">
      <i class="fa-brands fa-whatsapp wa-icon-marquee"></i>
      Share images via WhatsApp
    </a>

    <span class="mx-2">|</span>

    <a href="custom_design.html" class="marquee-link">
      Upload images & instructions here
    </a>
  </div>
</div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
    <script>
        console.log("_base.html: Setting global JS variables.");
        window.csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
        window.isUserLoggedIn = {{ 'true' if current_user.is_authenticated else 'false' }};
        window.userLoginUrl = "{{ url_for('user_login') }}"; // Expose login URL for redirection

        // Scroll navbar hide/show
        
  

let lastScrollTop = 0;
const navbar = document.getElementById("mainNavbar");
const categoryBar = document.getElementById("categoryBar");

window.addEventListener("scroll", () => {
  const currentScroll = window.scrollY;

  if (currentScroll > lastScrollTop && currentScroll > 100) {
    navbar.style.top = "-80px";
    if (categoryBar) categoryBar.style.top = "-120px";
  } else {
    navbar.style.top = "36px";
    if (categoryBar)
      categoryBar.style.top =
        "calc(var(--announcement-height) + var(--navbar-height))";
  }

  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
});




    </script>
    <script src="{{ url_for('static', filename='js/main.js', v=now().timestamp()) }}"></script>
    <script>
document.addEventListener("DOMContentLoaded", function () {
  const searchInput = document.getElementById("animatedSearch");
  if (!searchInput) return;

  const texts = [
    "Search press-on nails",
    "Search nail glue & kits",
    "Search trending designs",
    "Search best sellers"
  ];

  let textIndex = 0;
  let charIndex = 0;
  let deleting = false;

  function typeEffect() {
    if (document.activeElement === searchInput) return;

    const current = texts[textIndex];

    if (!deleting) {
      searchInput.placeholder = current.slice(0, charIndex++);
      if (charIndex > current.length + 6) deleting = true;
    } else {
      searchInput.placeholder = current.slice(0, charIndex--);
      if (charIndex < 0) {
        deleting = false;
        textIndex = (textIndex + 1) % texts.length;
      }
    }
  }

  setInterval(typeEffect, 120);
});

        console.log("_base.html: DOMContentLoaded fired. Initializing flashed messages and cart count.");
        // Custom alert function (replicated from main.js for immediate availability if needed)
        // This is a fallback and main.js's version is preferred.
        function showCustomAlert(message, type = 'info') {
            const container = document.getElementById('flash-messages-container') || document.body;
            const alertDiv = document.createElement('div');
            alertDiv.className = `custom-alert alert-${type}`;
            alertDiv.style.zIndex = 9999;
            alertDiv.innerHTML = `
                <span class="custom-alert-message">${message}</span>
                <button class="ml-4 text-lg font-bold" onclick="this.parentElement.remove()">&times;</button>
            `;
            container.appendChild(alertDiv);

            setTimeout(() => {
                alertDiv.remove();
            }, 5000); // Remove after 5 seconds
        }

        // Display flashed messages from Flask
        document.addEventListener('DOMContentLoaded', function() {
            const flashedMessages = JSON.parse('{{ get_flashed_messages(with_categories=true) | tojson | safe }}');
            flashedMessages.forEach(function(message) {
                showCustomAlert(message[1], message[0]);
            });

            // Initial fetch of cart count when the page loads
            // This will now rely on main.js's updateCartCountDisplay
            // Use a small delay to ensure main.js has definitely loaded and defined updateCartCountDisplay
            setTimeout(() => {
                if (typeof window.updateCartCountDisplay === 'function') {
                    window.updateCartCountDisplay();
                } else {
                    console.warn("_base.html: window.updateCartCountDisplay not found after delay. Fallback to direct fetch.");
                    fetch('/get_cart_count')
                        .then(response => response.json())
                        .then(data => {
                            const cartCountElement = document.getElementById('cart-count');
                            if (cartCountElement) {
                                cartCountElement.textContent = data.cart_count;
                                cartCountElement.style.display = data.cart_count > 0 ? 'inline-block' : 'none';
                            }
                        })
                        .catch(error => console.error('Error fetching cart count in _base.html fallback:', error));
                }
            }, 200); // Give main.js a bit more time
        });
    </script>

    <script>
    window.updateCartCountDisplay = function () {
        const cartCount = localStorage.getItem('cartCount');
        const cartCountElement = document.getElementById('cart-count');
        if (!cartCountElement) return;

        if (cartCount && parseInt(cartCount) > 0) {
            cartCountElement.textContent = cartCount;
            cartCountElement.style.display = 'inline-block';
        } else {
            cartCountElement.textContent = '';
            cartCountElement.style.display = 'none';
        }
    };



const announcements = [
  "üöö Free Shipping on orders above ‚Çπ999",
  "üéâ Get 15% OFF on your first order ‚Äì Code: NAILMART",
  "üî• Trending Nail Designs ‚Äì Limited Stock",
  "üíÖ Premium Press-On Nails loved by Nail Artists",
  `
  ‚ú® Get your <strong>CUSTOM DESIGN</strong> üíÖüèª 
  <a href="custom_design.html" class="custom-link">
    Share your idea or image here
  </a>
 <a href="https://wa.me/919330482697?text=Hi%20Guruji%2C%20I%20want%20a%20custom%20nail%20design%20üíÖüèª"
   target="_blank"
   title="Chat with us on WhatsApp">
  <i class="fa-brands fa-whatsapp wa-icon-announcement"></i>
</a>


  `
];

let aIndex = 0;
const el = document.getElementById("announcementText");

function rotateAnnouncement() {
  el.style.opacity = 0;
  setTimeout(() => {
    el.innerHTML = announcements[aIndex];
    el.style.opacity = 1;
    aIndex = (aIndex + 1) % announcements.length;
  }, 300);
}

rotateAnnouncement();
setInterval(rotateAnnouncement, 3500);

    
</script>


    {% block extra_js %}{% endblock %}

  
    <!-- Global Loading Placeholder -->
<div id="loading-placeholder" style="display: none;">
    <div class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-60 z-[9999]">
        <div class="text-center text-white text-xl font-semibold animate-pulse">
            ‚è≥ Uploading... Please wait<br>
            üôè Do not close or refresh the page
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
</body>
</html>